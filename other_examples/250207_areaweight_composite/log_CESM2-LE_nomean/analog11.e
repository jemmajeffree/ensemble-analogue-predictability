/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:135: UserWarning: Attempting to calculate /glade/work/jjeffree/results/area/base/detail/composite_5_CESM2-LE_nomean_tos_zos/10P_12m2varagreement30A_I1_L0_11.nc
  warnings.warn('Attempting to calculate ' + out_filename)
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:180: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'init_time':init_ens.pred_time.drop('pred_time'),
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:181: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'analogue_init_time':analogue.time.drop(('lib_dim','pred_time','pred_SMILE_M'))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:199: UserWarning: 11 1 16.937746286392212
  warnings.warn(str(lib_mi)+' '+str(init_month)+' '+str(time.time()-t0))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:135: UserWarning: Attempting to calculate /glade/work/jjeffree/results/area/base/detail/composite_5_CESM2-LE_nomean_tos_zos/10P_12m2varagreement30I_I1_L0_11.nc
  warnings.warn('Attempting to calculate ' + out_filename)
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:180: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'init_time':init_ens.pred_time.drop('pred_time'),
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:181: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'analogue_init_time':analogue.time.drop(('lib_dim','pred_time','pred_SMILE_M'))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:199: UserWarning: 11 1 17.618520498275757
  warnings.warn(str(lib_mi)+' '+str(init_month)+' '+str(time.time()-t0))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:135: UserWarning: Attempting to calculate /glade/work/jjeffree/results/area/base/detail/composite_5_CESM2-LE_nomean_tos_zos/10P_12m2varagreement30-10P_I1_L0_11.nc
  warnings.warn('Attempting to calculate ' + out_filename)
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:180: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'init_time':init_ens.pred_time.drop('pred_time'),
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:181: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'analogue_init_time':analogue.time.drop(('lib_dim','pred_time','pred_SMILE_M'))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:199: UserWarning: 11 1 18.19742751121521
  warnings.warn(str(lib_mi)+' '+str(init_month)+' '+str(time.time()-t0))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:135: UserWarning: Attempting to calculate /glade/work/jjeffree/results/area/base/detail/composite_5_CESM2-LE_nomean_tos_zos/10P_12m2varagreement10-30P_I1_L0_11.nc
  warnings.warn('Attempting to calculate ' + out_filename)
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:180: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'init_time':init_ens.pred_time.drop('pred_time'),
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:181: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'analogue_init_time':analogue.time.drop(('lib_dim','pred_time','pred_SMILE_M'))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:199: UserWarning: 11 1 18.8505916595459
  warnings.warn(str(lib_mi)+' '+str(init_month)+' '+str(time.time()-t0))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:135: UserWarning: Attempting to calculate /glade/work/jjeffree/results/area/base/detail/composite_5_CESM2-LE_nomean_tos_zos/10P_12m2varagreement30S_I1_L0_11.nc
  warnings.warn('Attempting to calculate ' + out_filename)
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:180: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'init_time':init_ens.pred_time.drop('pred_time'),
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:181: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'analogue_init_time':analogue.time.drop(('lib_dim','pred_time','pred_SMILE_M'))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:199: UserWarning: 11 1 19.50013828277588
  warnings.warn(str(lib_mi)+' '+str(init_month)+' '+str(time.time()-t0))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:135: UserWarning: Attempting to calculate /glade/work/jjeffree/results/area/base/detail/composite_5_CESM2-LE_nomean_tos_zos/10P_12m2varagreement30N_I1_L0_11.nc
  warnings.warn('Attempting to calculate ' + out_filename)
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:180: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'init_time':init_ens.pred_time.drop('pred_time'),
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:181: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  'analogue_init_time':analogue.time.drop(('lib_dim','pred_time','pred_SMILE_M'))
/glade/u/home/jjeffree/ensemble-analogue-predictability/analogue_forecasting_saveall.py:199: UserWarning: 11 1 20.05365777015686
  warnings.warn(str(lib_mi)+' '+str(init_month)+' '+str(time.time()-t0))
2025-02-06 16:31:04,828 - distributed.worker - ERROR - Failed to communicate with scheduler during heartbeat.
Traceback (most recent call last):
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/comm/tcp.py", line 225, in read
    frames_nosplit_nbytes_bin = await stream.read_bytes(fmt_size)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tornado.iostream.StreamClosedError: Stream is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/worker.py", line 1250, in heartbeat
    response = await retry_operation(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/utils_comm.py", line 459, in retry_operation
    return await retry(
           ^^^^^^^^^^^^
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/utils_comm.py", line 438, in retry
    return await coro()
           ^^^^^^^^^^^^
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/core.py", line 1254, in send_recv_from_rpc
    return await send_recv(comm=comm, op=key, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/core.py", line 1013, in send_recv
    response = await comm.read(deserializers=deserializers)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/comm/tcp.py", line 236, in read
    convert_stream_closed_error(self, e)
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/comm/tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed) ConnectionPool.heartbeat_worker local=tcp://127.0.0.1:43878 remote=tcp://127.0.0.1:44135>: Stream is closed
2025-02-06 16:31:04,829 - distributed.worker - ERROR - Failed to communicate with scheduler during heartbeat.
Traceback (most recent call last):
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/comm/tcp.py", line 225, in read
    frames_nosplit_nbytes_bin = await stream.read_bytes(fmt_size)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tornado.iostream.StreamClosedError: Stream is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/worker.py", line 1250, in heartbeat
    response = await retry_operation(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/utils_comm.py", line 459, in retry_operation
    return await retry(
           ^^^^^^^^^^^^
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/utils_comm.py", line 438, in retry
    return await coro()
           ^^^^^^^^^^^^
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/core.py", line 1254, in send_recv_from_rpc
    return await send_recv(comm=comm, op=key, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/core.py", line 1013, in send_recv
    response = await comm.read(deserializers=deserializers)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/comm/tcp.py", line 236, in read
    convert_stream_closed_error(self, e)
  File "/glade/work/jjeffree/conda-envs/jj_default2/lib/python3.12/site-packages/distributed/comm/tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed) ConnectionPool.heartbeat_worker local=tcp://127.0.0.1:43884 remote=tcp://127.0.0.1:44135>: Stream is closed
